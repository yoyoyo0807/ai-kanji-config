<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›ç­”ã®ç¢ºèª - {{ title }}</title>
    <style>
        /* manual_input.html ã®CSSã‚’ã“ã“ã«ã‚³ãƒ”ãƒ¼ */
        body { font-family: sans-serif; background: #f4f5f7; padding: 15px; text-align: center; }
        .card { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0; }
        .time-btn { padding: 15px 5px; border: 2px solid #ddd; border-radius: 12px; background: white; font-size: 0.9rem; cursor: pointer; }
        
        /* OKï¼ˆç©ºã„ã¦ã„ã‚‹ï¼‰ã®çŠ¶æ…‹ */
        .time-btn.selected { background: #e8f5e9; border-color: #4caf50; color: #2e7d32; }
        /* NGï¼ˆäºˆå®šã‚ã‚Šï¼‰ã®çŠ¶æ…‹ */
        .time-btn.busy { background: #ffebee; border-color: #ef5350; color: #c62828; opacity: 0.7; }
        
        .submit-btn { width: 100%; padding: 15px; background: #00b900; color: white; border: none; border-radius: 30px; font-weight: bold; font-size: 1.1rem; }
        .privacy-msg { font-size: 0.75rem; color: #666; margin-top: 15px; padding: 10px; background: #f9f9f9; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="card">
        <h2 id="eventTitle">{{ title }}</h2>
        <p>ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰ç©ºãæ™‚é–“ã‚’è‡ªå‹•å…¥åŠ›ã—ã¾ã—ãŸã€‚<br>ã‚¿ãƒƒãƒ—ã§èª¿æ•´ã‚‚å¯èƒ½ã§ã™ã€‚</p>

        <div class="grid" id="slotGrid">
            </div>

        <button class="submit-btn" onclick="sendResponse()">ã“ã®å†…å®¹ã§å›ç­”ã‚’ç¢ºå®šã™ã‚‹</button>
        
        <div class="privacy-msg">
            ğŸ›¡ï¸ Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®å…·ä½“çš„ãªäºˆå®šåã¯èª°ã«ã‚‚é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚ã€ŒOK/NGã€ã®çµæœã®ã¿ãŒå¹¹äº‹ã«ä¼ã‚ã‚Šã¾ã™ã€‚
        </div>
    </div>

    <script>
        // Flaskã‹ã‚‰æ¸¡ã•ã‚ŒãŸã€Œäºˆå®šã‚ã‚Šã€ã®ãƒªã‚¹ãƒˆ
        const busySlots = {{ busy_slots | tojson }};
        
        // ä»®ã®è¡¨ç¤ºæœŸé–“ï¼ˆæœ¬æ¥ã¯å¹¹äº‹ã®æŒ‡å®šã«åˆã‚ã›ã‚‹ï¼‰
        const dates = ["2025-12-30", "2025-12-31", "2026-01-01"];
        const times = ["19:00", "20:00", "21:00"];

        const grid = document.getElementById('slotGrid');

        dates.forEach(date => {
            times.forEach(time => {
                const btn = document.createElement('button');
                btn.className = 'time-btn';
                
                const slotKey = `${date}_${time}`;
                const displayDate = date.split('-').slice(1).join('/'); // 12/30å½¢å¼
                btn.innerHTML = `<div>${displayDate}</div><strong>${time}</strong>`;

                // ã€è‡ªå‹•åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã€‘äºˆå®šãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                if (busySlots.includes(slotKey) || busySlots.includes(date + "_ALLDAY")) {
                    btn.classList.add('busy'); // äºˆå®šã‚ã‚Šï¼ˆèµ¤ï¼‰
                    btn.dataset.status = "ng";
                } else {
                    btn.classList.add('selected'); // ç©ºãï¼ˆç·‘ï¼‰
                    btn.dataset.status = "ok";
                }

                // ã‚¿ãƒƒãƒ—ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ã«ã™ã‚‹
                btn.onclick = () => {
                    if (btn.dataset.status === "ok") {
                        btn.classList.remove('selected');
                        btn.classList.add('busy');
                        btn.dataset.status = "ng";
                    } else {
                        btn.classList.remove('busy');
                        btn.classList.add('selected');
                        btn.dataset.status = "ok";
                    }
                };
                grid.appendChild(btn);
            });
        });

        function sendResponse() {
            alert("å›ç­”ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¦LINEã«æˆ»ã£ã¦ãã ã•ã„ã€‚");
            window.close();
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå¹¹äº‹ãã‚“ - æ–°è¦ä½œæˆ</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: -apple-system, sans-serif; background: #f4f5f7; margin: 0; padding: 15px; padding-bottom: 120px; }
        .container { max-width: 500px; margin: auto; background: white; border-radius: 16px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
        .section-title { font-size: 0.95rem; font-weight: bold; border-left: 4px solid #00b900; padding-left: 10px; margin: 20px 0 10px; }
        .required { color: #ff0000; font-size: 0.7rem; vertical-align: middle; margin-left: 5px; border: 1px solid #ff0000; border-radius: 3px; padding: 1px 3px; }
        input, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; margin: 5px 0; box-sizing: border-box; font-size: 1rem; }
        input:focus, textarea:focus { border-color: #00b900; outline: none; }
        .date-row { display: flex; align-items: center; gap: 10px; }
        .btn-submit { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 450px; background: #00b900; color: white; border: none; padding: 18px; border-radius: 30px; font-weight: bold; font-size: 1rem; box-shadow: 0 4px 15px rgba(0,0,0,0.3); cursor: pointer; }
        .btn-submit:disabled { background: #ccc; }
        .note { font-size: 0.75rem; color: #888; margin: 5px 0 15px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“… ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½œæˆ</h1>
        
        <div class="section-title">ã‚¤ãƒ™ãƒ³ãƒˆå<span class="required">å¿…é ˆ</span></div>
        <input type="text" id="title" placeholder="ä¾‹ï¼šå¿˜å¹´ä¼šã€ã€‡ã€‡ã•ã‚“èª•ç”Ÿæ—¥ä¼š">

        <div class="section-title">é–‹å‚¬æœŸé–“<span class="required">å¿…é ˆ</span></div>
        <div class="date-row">
            <input type="date" id="start"> ã€œ <input type="date" id="end">
        </div>
        <p class="note">â€»ã“ã®æœŸé–“å†…ã§å…¨å“¡ã®ç©ºãæ™‚é–“ã‚’AIãŒæ¢ã—ã¾ã™ã€‚</p>

        <div class="section-title">é–‹å‚¬åœ°ï¼ˆä»»æ„ï¼‰</div>
        <input type="text" id="location" placeholder="ä¾‹ï¼šæ–°å®¿é§…ä»˜è¿‘ã€æ¸‹è°·ã®ã‚¤ã‚¿ãƒªã‚¢ãƒ³">

        <div class="section-title">å†…å®¹ãƒ»ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰</div>
        <textarea id="note" rows="3" placeholder="ä¾‹ï¼šä¼šè²»ã¯5000å††ç¨‹åº¦ã®äºˆå®šã§ã™ã€‚æ¥½ã—ã¿ã¾ã—ã‚‡ã†ï¼"></textarea>

        <button class="btn-submit" id="main-btn" onclick="sendInvitation()" disabled>èª­ã¿è¾¼ã¿ä¸­...</button>
    </div>

    <script>
        const LIFF_ID = "2008718467-wSHMbZKY";
        let myProfile = null;

        liff.init({ liffId: LIFF_ID }).then(async () => {
            if (!liff.isLoggedIn()) {
                liff.login();
            } else {
                myProfile = await liff.getProfile();
                const btn = document.getElementById('main-btn');
                btn.disabled = false;
                btn.innerText = "æ‹›å¾…ã‚’é€ã‚‹ï¼ˆé€ä¿¡å…ˆé¸æŠã¸ï¼‰";
            }
        }).catch(err => alert("LIFFåˆæœŸåŒ–å¤±æ•—: " + err.message));

        async function sendInvitation() {
            const title = document.getElementById('title').value;
            const start = document.getElementById('start').value;
            const end = document.getElementById('end').value;
            const location = document.getElementById('location').value || "æœªå®š";
            const note = document.getElementById('note').value || "ç‰¹ã«ãªã—";
            
            if(!title || !start || !end) {
                alert("ã‚¤ãƒ™ãƒ³ãƒˆåã¨é–‹å‚¬æœŸé–“ã¯å¿…ãšå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
                return;
            }

            if (liff.isApiAvailable('shareTargetPicker')) {
                liff.shareTargetPicker([
                    {
                        "type": "flex",
                        "altText": `ğŸ“… ${title} ã®æ‹›å¾…çŠ¶`,
                        "contents": {
                            "type": "bubble",
                            "body": {
                                "type": "box", "layout": "vertical",
                                "contents": [
                                    {"type": "text", "text": "ğŸ“… æ—¥ç¨‹èª¿æ•´ã®æ‹›å¾…", "weight": "bold", "size": "sm", "color": "#00b900"},
                                    {"type": "text", "text": title, "weight": "bold", "size": "xl", "margin": "md", "wrap": true},
                                    {"type": "text", "text": `${myProfile.displayName}ã•ã‚“ã‹ã‚‰ã®ãŠèª˜ã„`, "size": "xs", "color": "#888888"},
                                    {"type": "separator", "margin": "lg"},
                                    {"type": "box", "layout": "vertical", "margin": "lg", "spacing": "sm", "contents": [
                                        {"type": "box", "layout": "baseline", "spacing": "sm", "contents": [
                                            {"type": "text", "text": "æœŸé–“", "color": "#aaaaaa", "size": "sm", "flex": 1},
                                            {"type": "text", "text": `${start} ã€œ ${end}`, "wrap": true, "color": "#666666", "size": "sm", "flex": 4}
                                        ]},
                                        {"type": "box", "layout": "baseline", "spacing": "sm", "contents": [
                                            {"type": "text", "text": "å ´æ‰€", "color": "#aaaaaa", "size": "sm", "flex": 1},
                                            {"type": "text", "text": location, "wrap": true, "color": "#666666", "size": "sm", "flex": 4}
                                        ]},
                                        {"type": "box", "layout": "baseline", "spacing": "sm", "contents": [
                                            {"type": "text", "text": "ãƒ¡ãƒ¢", "color": "#aaaaaa", "size": "sm", "flex": 1},
                                            {"type": "text", "text": note, "wrap": true, "color": "#666666", "size": "sm", "flex": 4}
                                        ]}
                                    ]},
                                    {"type": "text", "text": "âš ï¸ å›ç­”æœŸé™: 12æ™‚é–“ä»¥å†…", "size": "xs", "color": "#ff0000", "margin": "xl", "weight": "bold", "align": "center"}
                                ]
                            },
                            "footer": {
                                "type": "box", "layout": "vertical", "spacing": "sm",
                                "contents": [
                                    {
                                        "type": "button", "style": "primary", "color": "#00b900",
                                        "action": { 
                                            "type": "uri", "label": "âœ… å‚åŠ ã™ã‚‹", 
                                            "uri": `https://liff.line.me/${LIFF_ID}/answer?res=yes&title=${encodeURIComponent(title)}` 
                                        }
                                    },
                                    {
                                        "type": "button", "style": "secondary",
                                        "action": { 
                                            "type": "uri", "label": "âŒ è¡Œã‘ãªã„", 
                                            "uri": `https://liff.line.me/${LIFF_ID}/answer?res=no` 
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]).then((res) => {
                    if (res) liff.closeWindow();
                }).catch(err => console.error(err));
            }
        }
    </script>
</body>
</html>
